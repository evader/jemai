\ncat <<'EOF' > ~/jemai_nuke_and_fix.sh\n#!/bin/bash\nset -e\n\necho \"===== JEMAI NUKE & FIX: Ollama + Open WebUI Reset =====\"\n\n# 1. Kill anything using port 11434\nPORT=11434\ntry=0\nwhile true; do\n  PIDS=$(sudo lsof -t -i :$PORT || true)\n  if [ ! -z \"$PIDS\" ]; then\n    echo \"[KILL] Processes using :$PORT: $PIDS\"\n    sudo kill -9 $PIDS || true\n    sleep 2\n    ((try++))\n    if [ $try -gt 5 ]; then\n      echo \"[FAIL] Port $PORT still in use after repeated kills. Exiting.\"\n      sudo lsof -i :$PORT || true\n      exit 1\n    fi\n  else\n    echo \"[OK] No rogue process using :$PORT\"\n    break\n  fi\ndone\n\n# 2. Stop & remove ALL ollama containers\necho \"[1/6] Stopping & removing ALL Ollama containers...\"\ndocker ps -a --filter \"ancestor=ollama/ollama:latest\" -q | xargs -r docker rm -f || true\ndocker ps -a --filter \"name=ollama\" -q | xargs -r docker rm -f || true\n\n# 3. Stop & remove ALL open-webui containers\necho \"[2/6] Stopping & removing ALL Open WebUI containers...\"\ndocker ps -a --filter \"ancestor=ghcr.io/open-webui/open-webui:main\" -q | xargs -r docker rm -f || true\ndocker ps -a --filter \"name=open-webui\" -q | xargs -r docker rm -f || true\n\n# 4. Remove duplicate ollama/openwebui volumes (EXCEPT canonical)\necho \"[3/6] Removing duplicate ollama/openwebui volumes...\"\nfor vol in $(docker volume ls -q | grep -E 'ollama|openwebui' | grep -v -e '^ollama$' -e '^openwebui_data$'); do\n  echo \"[DEL] Volume: $vol\"\n  docker volume rm $vol || true\ndone\n\n# 5. Print volume state\necho \"[INFO] Remaining Docker volumes:\"\ndocker volume ls | grep -E 'ollama|openwebui' || true\n\n# 6. Start fresh ollama, with up to 5 retries\necho \"[4/6] Starting fresh Ollama container (ollama:11434)...\"\ntry=0\nwhile true; do\n  docker run -d \\\n    --name ollama \\\n    --restart always \\\n    -p 11434:11434 \\\n    -v ollama:/root/.ollama \\\n    ollama/ollama:latest && break\n  sleep 2\n  ((try++))\n  if [ $try -gt 5 ]; then\n    echo \"[FAIL] Still can't bind Ollama to 11434 after 5 tries.\"\n    sudo lsof -i :11434 || true\n    docker ps -a\n    exit 1\n  fi\ndone\n\n# 7. Start fresh open-webui\necho \"[5/6] Starting fresh Open WebUI (open-webui:8080)...\"\ndocker run -d \\\n  --name open-webui \\\n  --restart always \\\n  -p 8080:8080 \\\n  -v openwebui_data:/app/backend/data \\\n  ghcr.io/open-webui/open-webui:main\n\nsleep 2\n\n# 8. Print status\necho \"[INFO] Final running containers:\"\ndocker ps --format \"table {{.Names}}\\t{{.Image}}\\t{{.Status}}\\t{{.Ports}}\"\n\necho \"[INFO] Port check (should be one ollama, one open-webui):\"\nsudo lsof -i :11434 || echo \"No process found on :11434\"\nsudo lsof -i :8080  || echo \"No process found on :8080\"\n\necho\necho \"===[DONE]=== If you see both containers running & ports listening, you are ready.\"\nEOF\n\nchmod +x ~/jemai_nuke_and_fix.sh\necho \"Now run: sudo ~/jemai_nuke_and_fix.sh\"\n