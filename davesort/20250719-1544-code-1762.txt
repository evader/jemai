\n#!/bin/bash\nset -e\n\necho \"=== STOPPING ALL JEM AI CONTAINERS ===\"\ndocker compose -f /opt/jemai_prod/docker_setup/docker-compose.yml down --remove-orphans\n\necho \"=== REMOVING JEM AI CORE CONTAINER AND IMAGE ===\"\ndocker rm -f jemai_prod_core || true\ndocker rmi docker_setup-jemai_core || true\n\necho \"=== CLEANING UNUSED DOCKER RESOURCES ===\"\ndocker system prune -f --volumes\n\necho \"=== KILLING LOCAL PROCESSES ON PORTS 5000, 5678, 5679 ===\"\nsudo lsof -t -i:5000 | xargs -r sudo kill -9 || true\nsudo lsof -t -i:5678 | xargs -r sudo kill -9 || true\nsudo lsof -t -i:5679 | xargs -r sudo kill -9 || true\n\necho \"=== CHECKING ENV VARS in .env ===\"\nif [ ! -f /opt/jemai_prod/docker_setup/.env ]; then\n  echo \"WARNING: .env file missing in /opt/jemai_prod/docker_setup\"\nelse\n  echo \".env contents:\"\n  cat /opt/jemai_prod/docker_setup/.env\nfi\n\necho \"=== REBUILDING ALL CONTAINERS CLEANLY ===\"\ncd /opt/jemai_prod/docker_setup\ndocker compose build --no-cache\n\necho \"=== STARTING ALL CONTAINERS ===\"\ndocker compose up -d\n\necho \"=== WAITING 10 SECONDS FOR SERVICES TO START ===\"\nsleep 10\n\necho \"=== LISTING ALL JEM AI CONTAINERS STATUS ===\"\ndocker ps --filter \"name=jemai_prod\"\n\necho \"=== TAILING jemai_core LOGS (last 50 lines) ===\"\ndocker compose logs jemai_core --tail=50\n\necho \"=== TESTING FLASK APP ENVIRONMENT ===\"\ndocker exec -it jemai_prod_core printenv | grep FLASK_APP || echo \"FLASK_APP not set\"\n\necho \"=== TESTING IF PORTS LISTENING ===\"\nss -tuln | grep -E \"5000|5678|5679\" || echo \"No expected ports listening\"\n\necho \"=== DIAGNOSTIC SCRIPT FINISHED ===\"\necho \"Check the logs above for errors. Try accessing http://localhost:5000\"\n